<!doctype html>
<meta charset="utf-8">
<title>Cuddle API Tester</title>
<pre id="out" style="white-space:pre-wrap;font:14px/1.4 ui-monospace,Consolas,Menlo,monospace">Loadingâ€¦</pre>
<script>
  // ðŸ‘‡ Use YOUR /exec URL (not /dev)
  const GAS_API = "https://script.google.com/macros/s/AKfycbzI9Vs_eAy1ESqfCdeRGHS_FkLCf6bgB7YNhy8y6hI/exec";

  const qp = new URLSearchParams(location.search);
  const order = qp.get("order_id") || "";
  const email = qp.get("email") || "";

  async function run(){
    if(!order){
      out.textContent = "Add ?order_id=YOUR_ID (&email=you%40mail.com optional) to the URL.";
      return;
    }
    const url = `${GAS_API}?fn=getCounts&order_id=${encodeURIComponent(order)}${email?`&email=${encodeURIComponent(email)}`:''}`;
    out.textContent = `GET ${url}\n\nWaitingâ€¦`;
    try{
      const res = await fetch(url, {cache:"no-store"});
      const txt = await res.text();
      out.textContent = `STATUS ${res.status}\n\n${txt}`;
    }catch(err){
      out.textContent = "Fetch error:\n" + (err && err.message ? err.message : String(err));
    }
  }
  run();
</script>
